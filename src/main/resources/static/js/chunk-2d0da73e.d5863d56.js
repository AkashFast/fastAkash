(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0da73e"],{"6c50":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{title:!1}},[a("a-form-model",{attrs:{layout:e.form.layout,model:e.form}},[a("a-form-model-item",{attrs:{label:"用户名称"}},[a("a-input",{attrs:{placeholder:"请输入用户名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("a-form-model-item",{attrs:{label:"企业邮箱"}},[a("a-input",{attrs:{placeholder:"请输入企业邮箱地址"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("a-form-model-item",{attrs:{label:"联系方式"}},[a("a-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),a("br"),a("br"),a("a-form-model-item",{attrs:{label:"数据状态"}},[a("a-radio-group",{model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("a-radio-button",{attrs:{value:"0"}},[e._v("正常")]),a("a-radio-button",{attrs:{value:"1"}},[e._v("已屏蔽")])],1)],1),a("a-form-model-item",{attrs:{label:"关联微信"}},[a("a-radio-group",{model:{value:e.form.wxState,callback:function(t){e.$set(e.form,"wxState",t)},expression:"form.wxState"}},[a("a-radio-button",{attrs:{value:"1"}},[e._v("是")]),a("a-radio-button",{attrs:{value:"-1"}},[e._v("否")])],1)],1),a("a-form-model-item",{attrs:{label:"可用授权"}},[a("a-tree-select",{staticStyle:{width:"320px"},attrs:{value:e.form.ridTitle,"tree-data":e.drawerRoleData.treeData,placeholder:"请选择用户权限「所属部门」","tree-default-expand-all":"","dropdown-style":{maxHeight:"400px",overflow:"auto"}},on:{select:e.treeSelChange}})],1),a("a-form-model-item",[a("a-button",{staticStyle:{width:"130px"},attrs:{type:"primary"},on:{click:e.changePage}},[e._v("检索")])],1),a("a-form-model-item",[a("a-button",{staticStyle:{width:"130px"},attrs:{type:"primary"},on:{click:e.exportUserData}},[e._v("导出")])],1),a("a-form-model-item",[a("a-button",{staticStyle:{width:"130px"},attrs:{type:"primary",hidden:e.setRoleDis},on:{click:e.add}},[e._v("新增系统用户")])],1)],1),a("br"),a("a-table",{attrs:{rowKey:"id",pagination:e.pagination,columns:e.columns,"data-source":e.data,loading:e.loading},on:{change:e.changePage},scopedSlots:e._u([{key:"name",fn:function(t){return a("a",{},[e._v(e._s(t))])}},{key:"action",fn:function(t,i){return[a("a-button",{staticStyle:{"margin-right":"15px",width:"100px"},attrs:{type:"primary",disabled:1===i.is_lock,hidden:e.setRoleDis},on:{click:function(t){return e.edit(i)}}},[e._v(" "+e._s(0===i.state?"编辑":"还原")+" ")]),a("a-button",{staticStyle:{"margin-right":"15px",width:"100px","background-color":"lightseagreen",color:"white"},attrs:{hidden:e.setRoleDis},on:{click:function(t){return e.setRole(i)}}},[e._v("授权")]),a("a-button",{staticStyle:{width:"100px"},attrs:{type:"danger",disabled:!(1!==i.is_lock&&!e.setRoleDis),hidden:e.setRoleDis},on:{click:function(t){return e.deleteData(i)}}},[e._v(" "+e._s(0===i.state?"屏蔽":"删除")+" ")])]}}])}),a("a-drawer",{attrs:{width:"650",title:e.drawerData.name,placement:"right",closable:!1,visible:e.visible},on:{close:e.onClose}},[a("a-form-model",{ref:"userForm",staticClass:"zero",attrs:{rules:e.rules,layout:"horizontal",model:e.drawerData,"label-col":{span:3},"wrapper-col":{span:18}}},[a("a-alert",{attrs:{message:"△ 「新建用户进行授权时,权限等级默认为普通用户」",hidden:e.setRoleDis,banner:""}}),a("br"),a("a-form-model-item",{ref:"name",attrs:{label:"姓名",prop:"name"}},[a("a-input",{attrs:{placeholder:"请输入系统用户名称"},model:{value:e.drawerData.name,callback:function(t){e.$set(e.drawerData,"name",t)},expression:"drawerData.name"}})],1),a("a-form-model-item",{ref:"email",attrs:{label:"邮箱",prop:"email"}},[a("a-input",{attrs:{placeholder:"请输入邮箱「可用于登陆凭证」"},model:{value:e.drawerData.email,callback:function(t){e.$set(e.drawerData,"email",t)},expression:"drawerData.email"}})],1),a("a-form-model-item",{ref:"mobile",attrs:{label:"联系方式",prop:"mobile"}},[a("a-input",{attrs:{placeholder:"请输入联系方式「可用于登陆凭证」"},model:{value:e.drawerData.mobile,callback:function(t){e.$set(e.drawerData,"mobile",t)},expression:"drawerData.mobile"}})],1),a("a-form-model-item",{ref:"role",attrs:{label:"可用授权",prop:e.editRole?"":"role",hidden:e.editRole}},[a("a-tree-select",{staticStyle:{width:"100%"},attrs:{value:e.drawerData.roleTitle,"tree-data":e.drawerRoleData.treeData,placeholder:"请选择用户权限「所属部门」","tree-default-expand-all":"","dropdown-style":{maxHeight:"400px",overflow:"auto"}},on:{select:e.treeSelChange2}})],1),a("a-form-model-item",{attrs:{label:"备注信息"}},[a("a-input",{attrs:{placeholder:"请输入用户的备注信息"},model:{value:e.drawerData.note,callback:function(t){e.$set(e.drawerData,"note",t)},expression:"drawerData.note"}})],1),a("a-form-model-item",{attrs:{label:"是否锁定"}},[a("a-popover",{attrs:{title:"数据锁定",placement:"bottom"},scopedSlots:e._u([{key:"content",fn:function(){return[a("p",[e._v("选择「是」时，当前数据将被系统锁定，后续无法更新及删除")]),a("p",[e._v("选择「否」时，系统将不会锁定当前数据")])]},proxy:!0}])},[a("a-radio-group",{model:{value:e.drawerData.is_lock,callback:function(t){e.$set(e.drawerData,"is_lock",t)},expression:"drawerData.is_lock"}},[a("a-radio-button",{attrs:{value:"1"}},[e._v("是")]),a("a-radio-button",{attrs:{value:"0"}},[e._v("否")])],1)],1)],1),a("br")],1),a("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-popconfirm",{attrs:{placement:"topRight","ok-text":"提交","cancel-text":"返回"},on:{confirm:e.onSave},scopedSlots:e._u([{key:"title",fn:function(){return[a("p",[e._v(e._s(e.confirm))])]},proxy:!0}])},[a("a-button",{attrs:{type:"primary"}},[e._v("提交保存")])],1),a("a-button",{staticStyle:{marginLeft:"8px"},on:{click:e.onClose}},[e._v("返回")])],1)],1),a("a-drawer",{attrs:{width:"650",title:e.drawerRoleData.name+"：授权",placement:"right",closable:!1,visible:e.visibleRole},on:{close:e.onCloseRole}},[a("a-alert",{attrs:{message:"△ 「请点击权限文字以进行授权操作」",banner:""}}),a("a-tree",{attrs:{checkable:"",checkStrictly:!0,"tree-data":e.drawerRoleData.treeData,showLine:!0},on:{select:e.treeNodeClick},scopedSlots:e._u([{key:"is_admin",fn:function(t){return[a("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(e._s("☆"+t.title+"「管理员」"))])]}},{key:"is_normal",fn:function(t){return[a("span",{staticStyle:{color:"green"}},[e._v(e._s(t.title+"「普通用户」"))])]}}]),model:{value:e.drawerRoleData.checkedList,callback:function(t){e.$set(e.drawerRoleData,"checkedList",t)},expression:"drawerRoleData.checkedList"}}),a("div",{staticStyle:{height:"50px"}}),a("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{staticStyle:{marginLeft:"8px"},on:{click:e.onCloseRole}},[e._v("返回")])],1)],1),a("a-modal",{attrs:{title:"授权提示",maskClosable:!1,closable:!1,visible:e.modalVisibleRole},on:{ok:e.modalRoleOk,cancel:e.modalRoleCancel}},[a("p",[e._v(e._s(e.infoChecked?"是否取消当前授权？":"是否设置当前角色的访问权限为管理者？「取消视为设置为普通用户」"))])]),a("a-modal",{attrs:{title:e.modalTitle,visible:e.modalVisible,"confirm-loading":e.confirmLoading},on:{ok:e.modalOk,cancel:e.modalCancel}},[a("p",[e._v(e._s(e.modalText))])])],1)},o=[],l=(a("b0c0"),a("5530")),r=a("c1df"),n=a.n(r),s=a("56cd"),d=a("b810"),c={data:function(){return{selData:"",afterEmail:"",setRoleDis:!0,rules:{name:[{required:!0,message:"请填写用户姓名！",trigger:"blur"}],role:[{required:!0,type:"string",message:"请给当前用户授权！",trigger:"blur"}],mobile:[{type:"string",pattern:/^1[0-9]{10}$|^[569][0-9]{7}$/,message:"请填写正确的用户联系方式！",trigger:"blur"}],email:[{type:"email",message:"请使用正确的邮箱格式！",trigger:"blur"},{required:!0,message:"请填写用户的企业邮箱！",trigger:"blur"}]},modalVisibleRole:!1,modalInfo:{},confirm:"我已确认并核实当前信息准确无误",modalTitle:"",modalVisible:!1,confirmLoading:!1,modalText:"",modalId:"",modalState:0,modalBack:!1,pagination:{total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,style:{textAlign:"center",width:"100%",marginTop:"25px"},postion:"both",pageSizeOptions:["10","20","50","100"],showTotal:function(e){return"共有 ".concat(e," 条数据")}},form:{layout:"inline",name:"",state:"0",rid:void 0,ridTitle:void 0,wxState:"-1"},drawerData:{},visible:!1,editRole:!1,drawerRoleData:{treeData:[],checkedList:[]},infoChecked:!1,visibleRole:!1,data:[],pageNo:0,pageSize:10,columns:[{title:"姓名",dataIndex:"name",key:"name"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"联系方式",dataIndex:"mobile",key:"mobile"},{title:"微信绑定",dataIndex:"openid",key:"openid",customRender:function(e,t,a){return void 0===e?"否":"是"}},{title:"状态",dataIndex:"state",key:"state",align:"center",customRender:function(e,t,a){return 1===t.is_lock?"正常🔒":0===e?"正常":"已屏蔽"}},{title:"操作",dataIndex:"action",width:"375px",scopedSlots:{customRender:"action"}}],loading:!1,systemName:"Fast·Akash",checkedListAdmin:""}},created:function(){this.getTableList(),this.getRoleTreeAdd(),this.mtp=Object(d["a"])("mt-p"),this.mtp,this.setRoleDis=!1},methods:{moment:n.a,exportUserData:function(){var e=this;this.exportFile("user","exportUserData","",this.selData).then((function(t){e.exportData(t,"系统用户信息")}))},treeSelChange:function(e,t,a){this.form.rid=t.dataRef.id,this.form.ridTitle=t.dataRef.title},treeSelChange2:function(e,t,a){this.drawerData.role=t.dataRef.id,this.drawerData.roleTitle=t.dataRef.title},changePage:function(e){void 0===e.current?(this.pageNo=0,this.pagination.current=0):(this.pagination.current=e.current,this.pagination.pageSize=e.pageSize,this.pageNo=e.current,this.pageSize=e.pageSize),this.getTableList()},bindRole:function(e){var t=this,a=this.modalInfo.node.dataRef.id;if(-1!==a){var i={rid:a,uid:this.drawerRoleData.id,is_admin:e?"1":"0",system_current_role:"529a36b2469a432f8a2474451b3e0fdd"};this.executeUnify("userRole","bindUserRole","",i).then((function(e){var a=t.dataClean(e);t.roleData=a,null!==a&&(t.success("当前权限已"+(t.infoChecked?"解绑":"绑定")+"成功"),t.getRoleTree())}))}},modalRoleOk:function(){this.bindRole(!0),this.modalVisibleRole=!1},modalRoleCancel:function(){this.infoChecked||this.bindRole(!1),this.modalVisibleRole=!1},treeNodeClick:function(e,t){this.modalVisibleRole=!0,this.infoChecked=t.node.checked,this.modalInfo=t},onCloseRole:function(){this.visibleRole=!1},setRole:function(e){this.drawerRoleData.name=e.name,this.drawerRoleData.id=e.id,this.getRoleTree()},getRoleTreeAdd:function(){var e=this,t={uid:"",systemName:this.systemName};this.executeUnify("userRole","getRoleMenuTree","",t).then((function(t){var a=e.dataClean(t);e.drawerRoleData.treeData=a}))},getRoleTree:function(){var e=this,t={uid:this.drawerRoleData.id,systemName:this.systemName};this.executeUnify("userRole","getRoleMenuTree","",t).then((function(a){var i=e.dataClean(a);e.drawerRoleData.treeData=i,e.executeUnify("userRole","getRoleChecked","",t).then((function(t){var a=e.dataClean(t);e.drawerRoleData.checkedList=a.checked,e.resetTree(i,a.adminChecked,a.normalChecked),e.visibleRole=!0}))}))},resetTree:function(e,t,a){for(var i=0;i<e.length;i++){for(var o=0;o<t.length;o++)t[o]===e[i].id&&(e[i].scopedSlots={title:"is_admin"});for(var l=0;l<a.length;l++)a[l]===e[i].id&&(e[i].scopedSlots={title:"is_normal"});e[i].disableCheckbox=!0,void 0!==e[i]&&void 0!==e[i].children&&e[i].children.length>0&&this.resetTree(e[i].children,t,a)}},onClose:function(){this.visible=!1,this.getTableList()},onSave:function(){var e=this,t=this;t.$refs.userForm.validate((function(a){if(!a)return!1;var i=t.drawerData,o={email:i.email};t.executeUnify("user","selectUserList",null,o).then((function(a){var o=t.dataClean(a);if(0===o.data.length||t.afterEmail===i.email){var l=i.id;i.version=void 0===l?0:parseInt(i.version)+1,i.create_time=null,i.last_time=null,t.editRole&&(i.role=""),e.editRole=!0,void 0===l?t.executeUnify("userRole","addUserInfo","",i).then((function(e){var a=t.dataClean(e);null!==a&&(t.success("系统用户信息新增成功"),t.onClose(),t.getTableList())})):t.executeUnify("","updateData","65b1634571894baa9a9a7462964f4bea",i).then((function(e){var a=t.dataClean(e);null!==a&&(t.success("系统用户信息更新成功"),t.onClose(),t.getTableList())}))}else s["a"].error({message:"错误提示",description:"当前邮箱已被使用！"})}))}))},edit:function(e){this.drawerData=e,this.editRole=!0,this.afterEmail=e.email+"",this.drawerData.is_lock=e.is_lock+"",0===e.state?this.visible=!0:(this.modalVisible=!0,this.modalTitle="确认还原?",this.modalText="是否确认将当前选中数据状态调整为「正常」?",this.modalId=e.id,this.modalState=e.state,this.modalBack=!0)},add:function(){this.drawerData={name:"",role:void 0,roleTitle:void 0,is_lock:"0"},this.editRole=!1,this.visible=!0},deleteData:function(e){var t=0===e.state?"屏蔽":"删除";this.modalVisible=!0,this.modalTitle="确认"+t+"?",this.modalText="是否确认将当前选中数据"+t+"?",this.modalId=e.id,this.modalState=e.state},modalCancel:function(){this.modalVisible=!1},modalOk:function(){var e=this,t={id:this.modalId},a=this.modalState;this.modalBack&&(t=this.drawerData,t.version=void 0===t.id?0:parseInt(t.version)+1,t.create_time=null,t.last_time=null,t.state=0),this.executeUnify("",this.modalBack?"updateData":0===a?"deleteDataSoft":"deleteData","65b1634571894baa9a9a7462964f4bea",t).then((function(i){var o=e.dataClean(i);null!==o&&(e.success(e.modalBack?"当前系统用户数据已还原":0===a?"系统用户信息屏幕成功":"系统用户信息删除成功"),e.modalVisible=!1,e.confirmLoading=!1,void 0!==t.id&&e.getTableList())}))},getTableList:function(){var e=this,t={name:this.form.name,email:this.form.email,mobile:this.form.mobile,wxState:this.form.wxState,rid:-1===this.form.rid?"":this.form.rid,state:this.form.state,pageNo:this.pageNo,pageSize:this.pageSize},a=this;a.selData=t,a.loading=!0,a.executeUnify("user","selectUserList",null,t).then((function(t){var i=a.dataClean(t);a.data=i.data;var o=Object(l["a"])({},e.pagination);o.total=i.total,a.pagination=o,a.loading=!1}))}}},m=c,u=a("2877"),h=Object(u["a"])(m,i,o,!1,null,null,null);t["default"]=h.exports}}]);